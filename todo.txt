
Release 6:

Changelog:

- Battle: Fixed new countries not shown on country selector.
- Battle: Fixed manual unit adding not working.
- Battle: Fixed order of naval units in fast planner.
- Battle: Fixed changing flank size not automatically updating the result.
- Battle: Fixed right-click cohort removal not always working correctly.
- Battle: Fixed cohort tooltip not appearing when moving mouse fast.
- Battle: Fixed total damage shown incorrectly on cohort tooltips (if target had experience).
- Battle: Improved flank size setting (1.4).
- Battle: Improved cohort tooltips (base damage is now part of strength/morale multipliers).
- Battle: Added support for backrow and backrow effectiveness (offensive and defensive), feature from EUIV.
- Battle: Added food consumption and storage to fast planner.
- Battle: Refactored state for armies (first step towards multiarmy battles).
- Battle: Added support for crossing terrain penalties not affecting attacker if their general has higher maneuver, feature from EUIV.
- Battle: Added inputs for general phase pips, feauture from EUIV.
- Battle: Added an input for tech level and culture, feauture from EUIV.
- Battle: Added support for showing and hiding inputs based on available game mechanics.
- Battle: Added more stats to Stats table (cost, maintenance, supply weight, food).
- Battle: Added clear units button at bottom.
- Battle: Added a new component for quickly adding units and changing their common attributes.
- Battle: Removed base damage from the UI (not very relevant information).
- Battle: Removed "Add and remove units" as obsolete.
- Analyze: Added average gold losses to naval simulations (from repair, from destroyed, from captured, etc.).
- Analyze: Added separate settings for calculating different things.
- Analyze: Renamed page name (from Stats).
- Analyze: Improved performance (but probably overall less performance because new mechanics from EUIV).
- Countries: Updated Export Hemp to give -10% Naval Damage taken instead of +5% Naval Damage done.
- Countries: Added naval capture chance from general martial (0.2% * martial).
- Countries: Added support for country specific combat width modifiers, feature from EUIV.
- Countries: Added new table at bottom to allow changing country specific attributes.
- Countries: Added new attributes for Fire, Shock and Maneuver pips, feature from EUIV.
- Countries: Added a new attribute for flank ratio, feature from EUIV.
- Countries: Removed Global and General words from modifier targets (should be obvious without them.)
- Countries: Refactored general to be separate entity (second step towards multiarmy battles).
- Units: Updated balance changes from 1.3.2 (War Elephants damage against Infantry, Supply Train cost).
- Units: Updated 1 maneuver to Mega-Polyreme (no idea when this was changed).
- Units: Fixed order of naval units.
- Units: Fixed unit renaming not working (also fixed terrain and tactic renaming).
- Units: Improved maintenance costs (higher accuracy).
- Units: Added new attributes: food consumption and storage.
- Units: Added new attributes: capture chance and capture resist.
- Units: Added a new attribute Combat ability, feature from EUIV.
- Units: Added a new attribute Military tactics, feature from EUIV.
- Units: Added a new attribute for reducing daily morale losses, feature from EUIV.
- Units: Added new attributes for Fire and Shock phases, feature from EUIV.
- Units: Added new attributes for Fire damage done, Fire damage taken, Shock damage done and Shock damage taken, feature from EUIV.
- Units: Added new attributes for Offensive fire, Defensive fire, Offensive shock, Defensive shock, Offensive Morale and Defensive morale pips, feature from EUIV.
- Units: Added support for changing the base type of a unit (allows more flexible unit hierarchies, for EUIV).
- Units: Added weariness options (random morale / strength losses for new units) from removed "Add and remove units".
- Units: Removed support for changing unit mode (land or naval), instead it is derived from the base unit.
- Units: Removed support for global unit mode (units are now either land or naval units).
- Units: Removed can assault toggle button (attribute not used anywhere in simulator).
- Units: Refactored base stats to a base unit (simplifies code).
- Settings: Improve page layout which more clearly shows which settings affects land, naval or both.
- Settings: Improved settings for bug fixes (and some others), converted to checkbox settings.
- Settings: Improved names and descriptions for all settings.
- Settings: Updated a 20% increase to base damage values.
- Settings: Removed "Fix damage taken" setting as it is fixed in the game.
- Settings: Removed "Damage per roll" setting as it's now included in Multiplier for morale damage and Multiplier for strength damage settings.
- Settings: Updated Defender's advantage to be disabled by default (people seem to make wrong conclusions because of it).
- Settings: Added a new setting to enable backrow (support units are prioritized), feature from EUIV.
- Settings: Added a new setting for discipline reducing damage, feature from EUIV.
- Settings: Added a new setting for daily morale losses, feature from EUIV.
- Settings: Added a new setting for enabling fire and shock phases, feature from EUIV.
- Settings: Added a new setting for daily damage increase, feature from EUIV.
- Settings: Added a new setting for strength affecting maneuver, feature from EUIV.
- Settings: Added a new setting for insufficient support penalty, feature from EUIV.
- Settings: Added a new setting for morale damage based on max morale, feature from EUIV.
- Settings: Added a new setting for dynamic flanking calculation (to support 1.3 deployment).
- Settings: Added new settings for enabling/disabling different unit attributes.
- Settings: Added new settings for halving simulation dice rolls (massively increases performance).
- Settings: Added new settings for enabling/disabling existing game mechanics (martial, tactics, preferred unit types, etc.).

Settings:
 - discipline: Reduces damage, only increases damage, no effect.
 - general maneuver: Affects crossing, affects terrain, affects both, no effect.
 - general: martial, fire&shock, both
 - Show on main page current settings set (Imperator, EUIV, mixed), tooltip to show individual (or only changed?)
 - Better descriptions
 - Show default value
 - Show current change versus default value (for example faster battles, more randomness)
 - New settings for deployment / reinforcement order/attribute.
 - More sections for settings (at least new section for deployment and reinforcement, game mechanics, simulation settings).

EUIV:
 - Tooltip needs to show source of losses (to include daily loss)
 - Units: Show pips on selectors
 - General stats / traits:
 - Professionalism: Value from 0 to 100, slider?: Affects phase damage done/takenn.
 - Ideas / traditions / government / religion: Various buffs? Low priority.

Todo:
 - Combat massively tested (especially EUIV, but also different configurations).

Release++:

Todo:
 - Transfer could only show non-base stats for units, terrains and tactics (since base stats are supposed to regenerate?), currently it shows way too much information.
 - Refactor simluation to update only single parameter, also parameters split should make more sense
 - Some sort of place for business logic rules
 - Rowtype selectors could show unit priority? Different colors for main and flank. Frontline could slightly color tiles based on main/flank.
 - Combat things to combat reducer. Perhaps state as parameter when needed? Since it only changes same things as battle reducer,
 - Stats to show amount of traditions, trade, etc..
 - Definition functions probably all could mutate (mostly used in reducers?)
 - Winrate could automatically set precision based on unit count

Tests:
- utils tested
- check that reinforcement is stable (higher key ends in right position)

Tags:
 - Icons to frontline to show various things, with tooltips:
  * Defender's advantage (some kind of ninja icon?) - This is expected to be fixed so shouldn't waste time.
  * Very bad matchup, bad match up, good matchup, very good matchup (red or green arrows)
  * Flanking (attacking without being attacked)
  * No target (red sign)
 - Battle stats to show amount of tags acquired (hopefully gives a better view of the battle)
 - Battle stats to show individual units

Army management:
- Probably needed for multi-army battles because countries need to have multiple armies
- General selector to units page, renamed to army?
- Custom changes for whole country, renamed to country?
- Accordion for general?
- Accordion for reserve?
- Accordion for unit definitions?

- Accordions to more places?? (unit detail?)

Countries:
- Tag selector for tech (some inventions are tag specific)
- Tag preset selector for common tags (selects tradition, tag for tech and religion)

Land battle:
- Deployment order based also on manpower!! (before index), need to to test whether full strength is prioritized for both deploy and reinforce

Combat calculations:
- In the game, integer calculations are used so the result is rounded down after each step.
- This doesn't matter in Imperator because of higher precision but causes manpower to be bit off in EUIV.
- Implementing this slows down the combat a lot because precalculation won't be possible.
- Also the exact order of calculations must be researched or acquired from devs to get accurate results.